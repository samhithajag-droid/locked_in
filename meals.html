<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Meal Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-purple-50 min-h-screen flex items-center justify-center">

    <div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-2xl">
        <h2 class="text-3xl font-bold text-purple-700 mb-6 text-center">üçΩ Meal Tracker</h2>

        <!-- Form -->
        <form method="POST" class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
            <select name="meal_type" class="w-full p-3 border rounded-lg">
                <option disabled selected>Select meal type</option>
                <option>Breakfast</option>
                <option>Lunch</option>
                <option>Dinner</option>
                <option>Snack</option>
            </select>
            <input type="text" name="food" placeholder="Food name" class="w-full p-3 border rounded-lg" required>
            <input type="number" name="calories" placeholder="Calories" class="w-full p-3 border rounded-lg" required>
            <button type="submit" class="bg-purple-500 text-white p-3 rounded-lg hover:bg-purple-600 col-span-1 md:col-span-2">
                Save Meal
            </button>
        </form>

        <!-- Chart -->
        <h3 class="font-semibold text-lg mb-2 text-purple-800">Calories Breakdown</h3>
        <canvas id="mealChart" class="mb-6"></canvas>

        <script>
            const ctx = document.getElementById('mealChart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: {{ labels | tojson }},
                    datasets: [{
                        data: {{ data | tojson }},
                        backgroundColor: ['#2f00ffff', '#ece50dff', '#b04ba1b5', '#50d6ffff']
                    }]
                }
            });
        </script>

        <!-- Meal History -->
        <h3 class="font-semibold text-lg mb-2 text-purple-800">Meal History</h3>
        <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-purple-100">
                        <th class="p-2">Meal</th>
                        <th class="p-2">Food</th>
                        <th class="p-2">Calories</th>
                        <th class="p-2">Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for meal in meals %}
                    <tr class="border-t">
                        <td class="p-2">{{ meal.meal_type }}</td>
                        <td class="p-2">{{ meal.food }}</td>
                        <td class="p-2">{{ meal.calories }}</td>
                        <td class="p-2">{{ meal.date.strftime("%Y-%m-%d %H:%M") }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Back button below the box -->
    <div class="mt-6 w-full max-w-2xl">
        <a href="{{ url_for('home') }}" class="block bg-purple-700 text-white px-4 py-3 rounded-full text-center hover:bg-purple-800 transition">
            Back to Dashboard
        </a>
    </div>
    </div>

</body>
</html>
